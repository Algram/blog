webpackJsonp([0xb95bfcbfc252b800],{"./node_modules/json-loader/index.js!./.cache/json/raspberry-pi-podcast-downloader.json":function(a,s){a.exports={data:{markdownRemark:{html:'<p>As a regular listener to podcasts you will know the pain of not having\nthem available right when you need them most. There are tons of apps for your\nsmartphone that handle that but fewer programs for your computer. When it comes\nto something that can download podcasts to all your devices it gets tricky.</p>\n<p>This was the struggle that led me to the script I will show you now - <strong>The Podcast Automator</strong>.\nBasically I had my Raspberry Pi doing nothing all day and I wanted to use it for\nsomething productive. I also have a fairly big Dropbox which I can access from\nalmost every device I own.</p>\n<p>The script I wrote checks if a new podcast is available and downloads it to your\nRaspberry which in turn uploads it to your Dropbox. I kept everything fairly modular,\nso you can interchange Dropbox with practically anything – Samba, OwnCloud or\neven keep them on your Pi locally.</p>\n<p>How does the Pi know where to look for new podcasts you might ask? Well, almost\nevery one of those has a RSS-Feed that the script will parse and extract the\ndownload links for you. If you want to know how an example of such a feed looks,\ncheck out the one from <a href="http://www.badvoltage.org/feed/mp3/">Bad Voltage</a>.</p>\n<p>In the next few paragraphs I will explain all the steps necessary to get the\npodcast automation going. You can find the <a href="https://github.com/Algram/PodcastAutomator">full script at the GitHub repo here</a>.</p>\n<h2>Setup</h2>\n<p class="notice notice--info">For those who chose not to use Dropbox as a storage medium, ignore/adapt accordingly</p>\n<p>The first part of the script is the configuration part. It should be self explanatory.\nYou add the paths to the locations of the different folders and scripts. The <code>url</code>\nvariable holds all the feeds in a comma separated list.\nYou can get the <code>dropbox_uploader.sh</code> with the <code>dropbox_uploader.conf</code> from <a href="https://github.com/andreafabrizi/Dropbox-Uploader">this GitHub Repo</a>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>\n\nSAVE_DIR<span class="token operator">=</span>/home/user/some-dir/\nUPLOAD_DIR<span class="token operator">=</span>/some-dir-in-your-dropbox/\nDROPBOX_UPLOADER<span class="token operator">=</span>/path/to/your/dropbox_uploader.sh\nDROPBOX_UPLOADER_CONFIG<span class="token operator">=</span>/path/to/your/dropbox_uploader.conf\n\n<span class="token comment" spellcheck="true"># Feeds to monitor</span>\nurls<span class="token operator">=</span><span class="token string">"feed-url1,feed-url2,..."</span>\n</code></pre>\n      </div>\n<p>Next up is the interesting part – Okay, not quite. First the feed string gets converted into an array. Then the first request to the Dropbox gets made (This happens via the script mentioned earlier). The request returns a list of all the files that are in your <code>UPLOAD_DIR</code>.</p>\n<p>After that the script checks if there are new podcasts available. It basically iterates over the feed-list and compares it to the already downloaded files – Pretty easy, huh?\nA quick fix to the encoding (always trouble with that..) and we come to the last part of this section:</p>\n<blockquote>\n<p>If a feed from the feed list has a new podcast and isn’t in your Dropbox yet, download it</p>\n</blockquote>\n<p>The block above explains the entire logic of this part. All podcasts get downloaded to your <code>SAVE_DIR</code> – in my case that is the Pi’s local storage.</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token comment" spellcheck="true"># Split urls to monitor into an array</span>\nIFS<span class="token operator">=</span><span class="token string">\',\'</span> <span class="token function">read</span> -r -a urlArr <span class="token operator">&lt;&lt;&lt;</span> <span class="token string">"<span class="token variable">$urls</span>"</span>\n\n<span class="token comment" spellcheck="true"># Retrieve list of currently downloaded files with dropbox_uploader.sh</span>\nlistStr<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>$DROPBOX_UPLOADER -f $DROPBOX_UPLOADER_CONFIG list $UPLOAD_DIR<span class="token variable">)</span></span>\n\n<span class="token comment" spellcheck="true"># Check if new podcasts are available and download them to local pi storage</span>\n<span class="token comment" spellcheck="true"># Will need to split that up at some point since files could potentially be too big for the pis storage</span>\n<span class="token keyword">for</span> url <span class="token keyword">in</span> <span class="token string">"<span class="token variable">${urlArr[@]}</span>"</span>\n<span class="token keyword">do</span>\n  str<span class="token operator">=</span><span class="token punctuation">$(</span>wget -P <span class="token variable">$SAVE_DIR</span> -q -O- <span class="token variable">$url</span> <span class="token operator">|</span> <span class="token function">grep</span> -o <span class="token string">\'&lt;enclosure [^>]*url="[^"]*\'</span> <span class="token operator">|</span> <span class="token function">grep</span> -o <span class="token string">\'[^"]*$\'</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>\n  str<span class="token operator">=</span>$<span class="token punctuation">{</span>str<span class="token comment" spellcheck="true">##*/}</span>\n\n  <span class="token comment" spellcheck="true"># Replace url encoding spaces with real ones</span>\n  str<span class="token operator">=</span><span class="token variable">${str//%20/ }</span>\n  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$listStr</span>"</span> <span class="token operator">!=</span> *<span class="token string">"<span class="token variable">$str</span>"</span>* <span class="token punctuation">]</span><span class="token punctuation">]</span>\n  <span class="token keyword">then</span>\n\t<span class="token comment" spellcheck="true"># File isnt in dropbox yet, so download</span>\n\t<span class="token function">wget</span> -P <span class="token variable">$SAVE_DIR</span> -q -O- <span class="token variable">$url</span> <span class="token operator">|</span> <span class="token function">grep</span> -o <span class="token string">\'&lt;enclosure [^>]*url="[^"]*\'</span> <span class="token operator">|</span> <span class="token function">grep</span> -o <span class="token string">\'[^"]*$\'</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1 <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">wget</span> -c -P <span class="token variable">$SAVE_DIR</span> <span class="token operator">></span> /dev/null\n  <span class="token keyword">fi</span>\n<span class="token keyword">done</span>\n</code></pre>\n      </div>\n<p>This part is only for those who want to use Dropbox or any other <em>cloud</em> service. All the files in the local directory on the Pi get uploaded to Dropbox (again via the upload script mentioned above).</p>\n<p>Don’t forget to clean up the local directory as the last step. Otherwise this will get clogged up pretty quickly.</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token comment" spellcheck="true"># Upload the downloaded files to dropbox using dropbox_uploader.sh</span>\n<span class="token keyword">for</span> <span class="token function">file</span> <span class="token keyword">in</span> <span class="token variable">$SAVE_DIR*</span>\n<span class="token keyword">do</span>\n  <span class="token variable">$DROPBOX_UPLOADER</span> -f <span class="token variable">$DROPBOX_UPLOADER_CONFIG</span> -s upload <span class="token string">"<span class="token variable">${file}</span>"</span> <span class="token string">"<span class="token variable">${UPLOAD_DIR}</span>"</span>\n<span class="token keyword">done</span>\n\n<span class="token comment" spellcheck="true"># Clean tmp folder</span>\n<span class="token function">rm</span> -rf <span class="token variable">$SAVE_DIR*</span>\n</code></pre>\n      </div>\n<p>I hope you enjoy this little helper as much as I do. I even made a <strong>Telegram bot</strong> for it that tells me when a new podcast was downloaded to my Dropbox - If you want to know more about it, let me know.</p>\n<p>I also need feedback on my syntax theme. Do you like it?</p>',frontmatter:{title:"Automatically download Podcasts with the Raspberry Pi",keywords:"raspberry pi, podcasts, automatic downloading, automation, bash, script",githubIssue:null}}},pathContext:{slug:"/raspberry-pi-podcast-downloader/",prev:!1,next:{excerpt:"A while ago I found out that my Raspberry Pi B+ was not broken after all.\nI tried it with the SD card of my new RPi 2 and it worked great.\nSo I started searching for some spare SD cards – everyone has...",timeToRead:1,frontmatter:{date:"2016-04-16 20:31",path:"/sd-card-raspberry-pi/",category:"raspberry pi",keywords:"raspberry pi, sdcard, soldering, accident",title:"How to not add an SD card to the Raspberry Pi",githubIssue:null},fields:{slug:"/sd-card-raspberry-pi/"}}}}}});
//# sourceMappingURL=path---raspberry-pi-podcast-downloader-54721df58db5181be0e3.js.map